/**
 * angular-localization :: v1.1.3 :: 2015-01-30
 * web: https://github.com/doshprompt/angular-localization
 *
 * Copyright (c) 2015 | Rahul Doshi
 * License: MIT
 */
!function(a){"use strict";a.module("ngLocalize.Config",[]).value("localeConf",{basePath:"languages",defaultLocale:"en-US",sharedDictionary:"common",fileExtension:".lang.json",persistSelection:!0,cookieName:"COOKIE_LOCALE_LANG",observableAttrs:new RegExp("^data-(?!ng-|i18n)"),delimiter:"::"}),a.module("ngLocalize.Events",[]).constant("localeEvents",{resourceUpdates:"ngLocalizeResourcesUpdated",localeChanges:"ngLocalizeLocaleChanged",textUpdates:"ngLocalizeTextUpdated"}),a.module("ngLocalize",["ngSanitize","ngLocalize.Config","ngLocalize.Events","ngLocalize.InstalledLanguages"]).service("locale",["$injector","$http","$q","$log","$rootScope","$window","localeConf","localeEvents","localeSupported","localeFallbacks",function(b,c,d,e,f,g,h,i,j,k){function l(a){return a&&a.length&&new RegExp("^[\\w\\.-]+\\.[\\w\\.-]+\\w(:.*)?$").test(a)}function m(a){var b=a?a.split("."):"",c="";return b.length>1&&(c=b.slice(0,-1).join(".")),c}function n(a){var b=a?a.split("."):[],c="";return b.length&&(c=b[b.length-1]),c}function o(a){var b,c=null,d=a?a.split("."):[];if(d.length>1)for(c=y,b=0;b<d.length-1;b++){if(!c[d[b]]){c=null;break}c=c[d[b]]}return c}function p(a){var b,d=a?a.split("."):"",g=y,j=h.basePath+"/"+w;if(d.length>1){for(b=0;b<d.length-1;b++)g[d[b]]||(g[d[b]]={}),g=g[d[b]],j+="/"+d[b];g._loading||(g._loading=!0,j+=h.fileExtension,c.get(j).success(function(b){var c,d=m(a);for(c in b)b.hasOwnProperty(c)&&(g[c]=b[c]);delete g._loading,f.$broadcast(i.resourceUpdates),x[d]&&x[d].resolve(d)}).error(function(){e.error("[localizationService] Failed to load: "+j),delete g._loading}))}}function q(a){var b,c;return a=a||h.langFile,c=a+"._LOOKUP_",b=o(c),x[a]||(x[a]=d.defer()),b&&!b._loading?x[a].resolve(a):b||p(c),x[a].promise}function r(b){var c,e,f;if(a.isString(b))c=b.split(",");else{if(!a.isArray(b))throw new Error("locale.ready requires either an Array or comma-separated list.");c=b}return c.length>1?(f=[],c.forEach(function(a){f.push(q(a))}),e=d.all(f)):e=q(b),e}function s(b,c){var d=b,e=0;return c&&(a.isArray(c)?a.forEach(c,function(a,b){d=d.replace("%"+(b+1),a),d=d.replace("{"+(b+1)+"}",a)}):a.forEach(c,function(a,b){++e,d=d.replace("{"+b+"}",a),d=d.replace("%"+b,a),d=d.replace("%"+e,a),d=d.replace("{"+e+"}",a)})),d=d.replace(/\n/g,"<br>")}function t(b,c){var d,f,g,i="",j=!1;return a.isString(b)&&!c&&-1!=b.indexOf(h.delimiter)&&(g=b.split(h.delimiter),b=g[0],c=a.fromJson(g[1])),j=l(b),j?(a.isObject(c)||(c=[c]),d=o(b),d&&!d._loading?(f=n(b),d[f]?i=s(d[f],c):(e.info("[localizationService] Key not found: "+b),i="%%KEY_NOT_FOUND%%")):d||p(b)):i=b,i}function u(a){var b=-1!=j.indexOf(a)?a:k[a.split("-")[0]]||h.defaultLocale;b!=w&&(y={},x={},w=b,f.$broadcast(i.localeChanges,w),f.$broadcast(i.resourceUpdates),z&&z.put(h.cookieName,b))}function v(){return w}var w,x,y,z;return h.persistSelection&&b.has("$cookieStore")&&(z=b.get("$cookieStore")),u((z?z.get(h.cookieName):h.defaultLocale)||g.navigator.userLanguage||g.navigator.language),{ready:r,isToken:l,getPath:m,getKey:n,setLocale:u,getLocale:v,getString:t}}]).filter("i18n",["locale",function(a){return function(b,c){return a.getString(b,c)}}]).directive("i18n",["$sce","$rootScope","locale","localeEvents","localeConf",function(b,c,d,e,f){function g(a,d){d!==a.html()&&a.html(b.getTrustedHtml(d)),c.$broadcast(e.textUpdates,a)}function h(a,b,c){d.isToken(b)?d.ready(d.getPath(b)).then(function(){g(a,d.getString(b,c))}):g(a,b)}return function(b,c,d){var g;d.$observe("i18n",function(a,b){a&&a!=b&&h(c,a,g)}),a.forEach(d.$attr,function(a,b){f.observableAttrs.test(a)&&d.$observe(b,function(a,e){(a&&a!=e||!g||!g[b])&&(g=g||{},g[b]=d[b],h(c,d.i18n,g))})}),b.$on(e.resourceUpdates,function(){h(c,d.i18n,g)}),b.$on(e.localeChanges,function(){h(c,d.i18n,g)})}}]).directive("i18nAttr",["$rootScope","locale","localeEvents",function(a,b,c){return function(d,e,f){function g(e,g){var i,j=d.$eval(g),k=[];for(var l in j)i=j[l],b.isToken(i)&&-1==k.indexOf(b.getPath(i))&&k.push(b.getPath(i));b.ready(k).then(function(){var d="";for(var g in j)i=j[g],d=b.getString(i),h[g]!==d&&f.$set(g,h[g]=d);a.$broadcast(c.textUpdates,e)})}var h={};f.$observe("i18nAttr",function(a,b){a&&a!=b&&g(e,a)}),d.$on(c.resourceUpdates,function(){g(e,f.i18nAttr)}),d.$on(c.localeChanges,function(){g(e,f.i18nAttr)})}}]),a.module("ngLocalize.InstalledLanguages",[]).value("localeSupported",["en-US"]).value("localeFallbacks",{en:"en-US"}),a.module("ngLocalize.Version",[]).constant("localeVer","1.1.3")}(window.angular,window,document);
//# sourceMappingURL=angular-localization.min.map